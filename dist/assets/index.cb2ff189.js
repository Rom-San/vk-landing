var x=Object.defineProperty;var v=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable;var f=(t,e,o)=>e in t?x(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,p=(t,e)=>{for(var o in e||(e={}))E.call(e,o)&&f(t,o,e[o]);if(v)for(var o of v(e))P.call(e,o)&&f(t,o,e[o]);return t};import{v as C,b as m,r as V,o as r,c,a as i,d,t as b,n as u,w as g,e as k,F as _,f as O,g as A,h as y,i as L}from"./vendor.15386a3e.js";const N=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const h of n.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&a(h)}).observe(document,{childList:!0,subtree:!0});function o(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerpolicy&&(n.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?n.credentials="include":s.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(s){if(s.ep)return;s.ep=!0;const n=o(s);fetch(s.href,n)}};N();var B="/vk-landing/assets/phone.9fe2144b.svg",M="/vk-landing/assets/mail.f6f1960d.svg";function w(t){if(!!t){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="https://vk.com/js/api/openapi.js?169",e.onload=function(){VK.Retargeting.Init(t),VK.Retargeting.Hit()},document.head.appendChild(e)}}var U=(t,e)=>{const o=t.__vccOpts||t;for(const[a,s]of e)o[a]=s;return o};const D={directives:{mask:C.exports.mask},async created(){var e;const t=window.location.href;if(console.log("\u{1F680} ~ search",window.location),this.params=this.getQuery(t),!this.params)this.loader=!1;else{const o=this.params.ml;this.hash=this.params.hash;try{const a=await fetch(`${this.api}/mini-landing/${o}`);this.ml=await a.json(),this.loader=!1,document.title=this.ml.content.title,this.setDescription(),((e=this.ml)==null?void 0:e.additionalOptions.VkPixel)&&w(this.ml.additionalOptions.VkPixel),w()}catch(a){this.ml=null,this.loader=!1,console.log(a.message)}}},mounted(){m.supports("VKWebAppResizeWindow")&&setTimeout(()=>{const t=document.body.offsetHeight,e=t<8050?t:8050;m.send("VKWebAppResizeWindow",{height:e})},1e3)},data(){return{params:null,ml:null,hash:null,loader:!0,description:"",api:"https://prosto.bz/api",vkUrl:"https://vk.com/",youtubeUrl:"https://www.youtube.com/embed",vkUserEnter:"https://prosto.bz/ws/vk-user-enter",vkVideoUrl:"https://vk.com/video_ext.php?oid=",isInvalidPhone:!0,isInvalidEmail:!0,phone:null,phoneNumberLength:null,email:null,emailAttributes:!1,vkLink:"",agreement:!0}},computed:{getImage(){return this.ml.content?`${this.api}/file/${this.ml.content.image[0]}`:""},getVideo(){let t;const e=this.ml.content.video,o="?controls=0&modestbranding=1&showinfo=0&rel=0";if(e.includes("https://youtube.com")&&(t=e.replace("watch?v=","embed/")+o),e.includes("https://youtu.be")&&(t=e.replace("https://youtu.be",this.youtubeUrl)+o),e.includes("https://vk.com")){const a=e.replace("https://vk.com/video","").split("_");t=`${this.vkVideoUrl}${a[0]}&id=${a[1]}&hash=1b4beb5bfd0602dd`}return console.log("\u{1F680} ~ getVideo ~ result",t),t},getTitle(){var t;return((t=this.ml)==null?void 0:t.content)?this.ml.content.title:""},getText(){var t;return((t=this.ml)==null?void 0:t.content)?this.ml.content.text:""},getPhoneIcon(){return B},getEmailIcon(){return M},getButtons(){var t,e;return((e=(t=this.ml)==null?void 0:t.buttons)==null?void 0:e.length)?this.ml.buttons:[]},isButtonDisabled(){return this.isInvalidPhone&&this.ml.additionalOptions.showPhone||this.isInvalidEmail&&this.ml.additionalOptions.showEmail||!this.agreement}},methods:{async onButton(){if(!this.isButtonDisabled){try{await this.postData();const t=await this.allowMessages();console.log("\u{1F680} allowMessages",t);const e=await m.send("VKWebAppGetUserInfo");await fetch(this.vkUserEnter,{method:"post",body:JSON.stringify(p(p({},e),this.params)),headers:{"Content-Type":"application/json"}}),console.log("\u{1F680} ~ onButton ~ this.vkLink",this.vkLink)}catch(t){console.log("\u041E\u0448\u0438\u0431\u043A\u0430:",t)}this.vkLink=`${this.vkUrl}im?sel=-${this.ml.buttons[0].botIdInSocialNetwork}`,window.top.location.href=this.vkLink}},getQuery(t){let e={};return t.includes("#")?t.split("#")[1].split("&").forEach(s=>{const n=s.split("=");Object.assign(e,{[n[0]]:n[1]})}):(this.loader=!1,e=null),e},setDescription(){const t=this.ml.content.text.indexOf(".");this.description=this.ml.content.text.slice(0,t+1);const e=document.createElement("meta");e.setAttribute("name","description"),e.content=this.description,document.head.appendChild(e)},onChangePhone(){this.phoneNumberLength<11&&(this.isInvalidPhone=!0)},onChangeEmail(){this.emailAttributes?this.isInvalidEmail=!1:this.isInvalidEmail=!0},onClickPhone(){this.phone||(this.phone="+7")},onInputPhone(){const t=this.phone.replace(/[^\d]/g,"");this.phoneNumberLength=t.length,this.isInvalidPhone=this.phoneNumberLength<11},onInputEmail(){const t=/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;this.emailAttributes=t.test(this.email),this.isInvalidEmail=!this.emailAttributes},async postData(){const t={id:this.ml.buttons[0].commandId,fields:{email:this.email,phone:this.phone}};try{return(await fetch(`${this.api}/info`,{method:"POST",body:JSON.stringify(t)})).text()}catch(e){console.log(e.message)}},async allowMessages(){try{const t=parseInt(this.ml.buttons[0].botIdInSocialNetwork);console.log("\u{1F680} ~ groupId",t);const e=await m.send("VKWebAppAllowMessagesFromGroup",{group_id:t});return console.log("\u{1F680} ~ allowMessages",e),e}catch(t){return console.log("\u{1F680} ~ allowMessages ~ e",t),await this.allowMessages()}}}},z={key:0,class:"wrapper"},T={class:"minilanding"},j={class:"headline"},K=["src"],S=["src"],W={class:"container"},F={class:"title"},H={class:"content"},R={class:"text"},Z={class:"form"},G={key:0,class:"label"},J=["src"],Q=["src"],q={class:"buttons"},X=i("div",{class:"text"},"\u041F\u043E\u0434\u043F\u0438\u0441\u0430\u0442\u044C\u0441\u044F",-1),Y=[X],$={class:"footer"},ee=y(" \u0412\u044B \u0441\u043E\u0433\u043B\u0430\u0448\u0430\u0435\u0442\u0435\u0441\u044C \u0441\xA0 "),te=i("a",{href:"https://prostolp.com/policy.pdf",target:"_blank"}," \u0423\u0441\u043B\u043E\u0432\u0438\u044F\u043C\u0438 \u0438\u0441\u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u043D\u0438\u044F \u0438 \u041F\u043E\u043B\u0438\u0442\u0438\u043A\u043E\u0439 \u043A\u043E\u043D\u0444\u0438\u0434\u0435\u043D\u0446\u0438\u0430\u043B\u044C\u043D\u043E\u0441\u0442\u0438",-1),se=i("div",{class:"made-in"},[y(" \u0421\u0434\u0435\u043B\u0430\u043D\u043E \u043D\u0430 \u043F\u043B\u0430\u0442\u0444\u043E\u0440\u043C\u0435 "),i("a",{href:"http://prosto.bz",target:"_blank"},"prosto.bz")],-1),ne={key:1,id:"preloader"},oe=i("div",{id:"loader"},null,-1),ie=[oe],le={key:2,class:"empty"},ae=i("div",{class:"text"},"\u041D\u0435\u0442 \u0434\u0430\u043D\u043D\u044B\u0445",-1),re=[ae];function ce(t,e,o,a,s,n){const h=V("mask");return r(),c(_,null,[!s.loader&&s.ml?(r(),c("div",z,[i("div",T,[i("div",j,[s.ml.content.image?(r(),c("img",{key:0,class:"image",src:n.getImage,alt:""},null,8,K)):d("",!0),s.ml.content.video?(r(),c("iframe",{key:1,class:"video",width:"585",src:n.getVideo,frameborder:"0",allow:"autoplay; encrypted-media; fullscreen;"},null,8,S)):d("",!0)]),i("div",W,[i("div",F,b(n.getTitle),1),i("div",H,[i("div",R,b(n.getText),1),i("form",Z,[s.ml&&(s.ml.additionalOptions.showPhone||s.ml.additionalOptions.showEmail)?(r(),c("div",G," \u041E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u044B\u0435 \u043F\u043E\u043B\u044F \u0434\u043B\u044F \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044F ")):d("",!0),s.ml&&s.ml.additionalOptions.showPhone?(r(),c("div",{key:1,class:u(["input-block",{invalid:s.isInvalidPhone}])},[i("img",{class:"icon",src:n.getPhoneIcon,alt:""},null,8,J),g(i("input",{type:"tel","onUpdate:modelValue":e[0]||(e[0]=l=>s.phone=l),onClick:e[1]||(e[1]=(...l)=>n.onClickPhone&&n.onClickPhone(...l)),onInput:e[2]||(e[2]=(...l)=>n.onInputPhone&&n.onInputPhone(...l)),onChange:e[3]||(e[3]=(...l)=>n.onChangePhone&&n.onChangePhone(...l)),placeholder:"\u0412\u0435\u0434\u0438\u0442\u0435 \u0412\u0430\u0448 \u043D\u043E\u043C\u0435\u0440 \u0442\u0435\u043B\u0435\u0444\u043E\u043D\u0430"},null,544),[[h,"+7(###) ###-##-##"],[k,s.phone]])],2)):d("",!0),s.ml&&s.ml.additionalOptions.showEmail?(r(),c("div",{key:2,class:u(["input-block",{invalid:s.isInvalidEmail}])},[i("img",{class:"icon",src:n.getEmailIcon,alt:""},null,8,Q),g(i("input",{type:"email","onUpdate:modelValue":e[4]||(e[4]=l=>s.email=l),onInput:e[5]||(e[5]=(...l)=>n.onInputEmail&&n.onInputEmail(...l)),onChange:e[6]||(e[6]=(...l)=>n.onChangeEmail&&n.onChangeEmail(...l)),placeholder:"\u0412\u0435\u0434\u0438\u0442\u0435 \u0412\u0430\u0448 \u0435\u043C\u0435\u0439\u043B"},null,544),[[k,s.email]])],2)):d("",!0)]),i("div",q,[(r(!0),c(_,null,O(n.getButtons,l=>(r(),c("div",{class:u(["button",{disabled:n.isButtonDisabled}]),key:l.name},[i("div",{class:u(["link",{"not-allowed":n.isButtonDisabled}]),onClick:e[7]||(e[7]=(...I)=>n.onButton&&n.onButton(...I))},Y,2)],2))),128))])])]),i("div",$,[i("div",{class:u(["agreement",{"not-agreement":!s.agreement}])},[g(i("input",{type:"checkbox","onUpdate:modelValue":e[8]||(e[8]=l=>s.agreement=l)},null,512),[[A,s.agreement]]),ee,te],2),se])])])):d("",!0),s.loader?(r(),c("div",ne,ie)):d("",!0),!s.loader&&!s.ml?(r(),c("div",le,re)):d("",!0)],64)}var de=U(D,[["render",ce]]);L(de).mount("#app");
